"use strict";angular.module("ImageEditor",["ngMaterial","ngAnimate","ui.sortable","image.crop","image.text","image.drawing","image.filters","image.shapes","image.directives","image.basics"]).config(["$mdThemingProvider",function(e){e.theme("default").primaryPalette("deep-orange").accentPalette("brown")}]).controller("MainController",["$rootScope","$scope","$timeout","$$rAF","$mdBottomSheet","canvas","history","simpleShapes","filters",function(e,t,i,n,r,o,a,s,l){e.started=!1,e.isDemo=document.URL.indexOf("pixie.vebto.com")>-1,e.isIntegrationMode=!1;try{window.self!==window.top&&$("script",window.parent.document).each(function(t,i){return i.src.indexOf("pixie-integrate")>-1?(e.isIntegrationMode=!0,!1):void 0})}catch(c){e.isIntegrationMode=!1}e.isIntegrationMode&&(e.pixie=window.parent.Pixie),e.getParam=function(t){return e.pixie?e.pixie.getParams()[t]:window.PixieParams?window.PixieParams[t]:void 0},o.start(),$(".actions-menu").draggable({handle:".menu-header",containment:"body"}),e.canvas=o,e.history=a,e.shapes=s,e.loading=!1,e.animationEndEvent="webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",e.transitionEndEvent="webkitTransitionEnd mozTransitionEnd MSTransitionEnd oatransitionend atransitionend transitionend",e.maxPanelHeight=$(window).height()-120,e.openPanel=function(t,i){if(e.activePanel!==t){e.activePanel=t;var r=$('[data-name="'+t+'"]'),o=i.target.getBoundingClientRect(),a=r[0].getBoundingClientRect(),s=Math.min(.5,o.width/a.width),l=Math.min(.5,o.height/a.height);r.removeClass("transition-in").css("transform","translate3d("+(-a.left+o.left+o.width/2-a.width/2)+"px,"+(-a.top+o.top+o.height/2-a.height/2)+"px,0) scale("+s+","+l+")"),n(function(){$(r).addClass("transition-in").css("transform","")})}},e.isLoading=function(){i(function(){e.loading=!0})},e.isNotLoading=function(){i(function(){e.loading=!1})},e.activePanel=!1,e.activeTab=!1,e.keys={google_fonts:"AIzaSyDhc_8NKxXjtv69htFcUPe6A7oGSQ4om2o"},e.$watch("activePanel",function(){setTimeout(function(){$(window).resize()},100)}),e.resetUI=function(){i(function(){e.activePanel=null,e.activeTab="basics",s.selected=null,l.appliedFilters=[],e.history.all=[]})},o.fabric.on("object:selected",function(t){if("text"==t.target.name)e.activeTab="text";else if("sticker"==t.target.name&&"stickers"!==e.activeTab)e.activeTab="stickers";else if(t.target.name&&"simple-shapes"!==e.activeTab)for(var n=0;n<s.available.length;n++){var r=s.available[n];r.name===t.target.name&&"simple-shapes"!==e.activeTab&&(s.selected=r,e.activeTab="simple-shapes")}i(angular.noop)}),o.fabric.on("selection:cleared",function(){i(angular.noop)}),$("#viewport").on("click",function(e){"viewport"===e.target.id&&i(function(){o.fabric.deactivateAll().renderAll()})}),t.openBottomSheet=function(e){r.show({template:$("#"+e+"-sheet-template").html(),controller:"BottomSheetController"})},t.$on("$destroy",function(){$(".sp-container").remove()}),e.spacify=function(e){if(e){var t=e.replace(/([A-Z])/g," $1");return t.charAt(0).toUpperCase()+t.slice(1)}}}]).controller("BottomSheetController",["$rootScope","$scope","$mdBottomSheet","$mdDialog","simpleShapes",function(e,t,i,n,r){t.shapes=r,t.showDialog=function(e){n.show({template:$("#texture-upload-dialog-template").html(),targetEvent:e,controller:"BottomSheetController"})}}]);