"use strict";angular.module("image.text").directive("edFontsPagination",["$rootScope","fonts",function(t,e){return{restrict:"A",link:function(t,i){i.pagination({items:0,itemsOnPage:e.paginator.perPage,onPageClick:function(i){t.$apply(function(){e.paginator.selectPage(i)})}}),t.$watch("fonts.paginator.totalItems",function(t){t&&i.pagination("updateItems",t)})}}}]).factory("fonts",["$rootScope","$http","$timeout","$filter","localStorage",function(t,e,i,n,r){var o={loading:!1,paginator:{sourceItems:[],filteredItems:[],currentItems:[],perPage:17,totalItems:0,selectPage:function(t){this.currentItems=this.filteredItems.slice((t-1)*this.perPage,(t-1)*this.perPage+this.perPage),o.load()},filter:function(t){this.start(n("filter")(o.paginator.sourceItems,t))},start:function(t){this.filteredItems=t,this.totalItems=t.length,this.currentItems=t.slice(0,this.perPage),o.load()}},getAll:function(i){var n=this,o=r.get("googleFonts"),s=t.keys.google_fonts;return o?(n.paginator.sourceItems=o,i?n.paginator.filter(i):n.paginator.start(o)):void e.get("https://www.googleapis.com/webfonts/v1/webfonts?sort=popularity&key="+s).success(function(t){r.set("googleFonts",t.items),n.paginator.sourceItems=t.items,i?n.paginator.filter(i):n.paginator.start(t.items)})},load:function(e){var i=$("head");t.loading=!0,e?angular.isArray(e)||(e=[e]):e=$.map(o.paginator.currentItems,function(t){return t.family}),$(i).find("#dynamic-fonts").remove(),i.append('<link rel="stylesheet" id="dynamic-fonts" href="http://fonts.googleapis.com/css?family='+e.join("|").replace(/ /g,"+")+'">'),t.loading=!1},createLinkToFont:function(t){var e=t.replace(/ /g,"+"),i=$("#"+e);i[0]?i.attr("href","http://fonts.googleapis.com/css?family="+e):$("head").append('<link rel="stylesheet" id="'+e+'" href="http://fonts.googleapis.com/css?family='+e+'">')}};return o}]);