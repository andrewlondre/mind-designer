angular.module("image.shapes").controller("StickersController",["$scope","$rootScope","canvas","simpleShapes","history","settings",function(t,e,i,n,r,o){t.shapes=n,t.opacity=.9,e.$on("settings.ready",function(){for(var e=o.get("stickers"),i=e.length-1;i>=0;i--)e[i].items=new Array(e[i].items);t.categories=e}),t.activeCategory="doodles",t.activeStickerIsSvg=function(){var t=i.fabric.getActiveObject();return t&&angular.isDefined(t.svgUid)},t.isPanelEnabled=function(){var t=i.fabric.getActiveObject();return t&&"sticker"===t.name&&"stickers"===e.activeTab},t.setActiveCategory=function(e){t.activeCategory===e?t.activeCategory=!1:t.activeCategory=e},t.setOpacity=function(t){n.getShape("sticker").setOpacity(t),i.fabric.renderAll()},t.setColor=function(t){var e=n.getShape("sticker");if(e.isSameColor&&e.isSameColor()||!e.paths)e.setFill(t);else if(e.paths)for(var r=0;r<e.paths.length;r++)e.paths[r].setFill(t);i.fabric.renderAll()},t.addToCanvas=function(e,n,o){t.loading||(t.loading=!0,t.openPanel("stickers",o),"svg"===e.type?fabric.loadSVGFromURL("assets/images/stickers/"+e.name+"/"+n+"."+e.type,function(e,n){var o=fabric.util.groupSVGElements(e,n);o.name="sticker",i.fabric.add(o),o.scaleToHeight(.4*i.fabric.getHeight()),o.center(),o.setCoords(),i.fabric.setActiveObject(o),i.fabric.renderAll(),t.$apply(function(){t.loading=!1}),r.add("Added: Sticker","favorite")}):fabric.util.loadImage("assets/images/stickers/"+e.name+"/"+n+"."+e.type,function(e){var n=new fabric.Image(e);n.name="sticker",i.fabric.add(n),n.center(),n.setCoords(),n.scaleToHeight(.4*i.original.height),i.fabric.setActiveObject(n),i.fabric.renderAll(),t.$apply(function(){t.loading=!1}),r.add("Added: Sticker","favorite")}))}}]);